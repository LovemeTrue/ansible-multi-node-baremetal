# Generated by iptables-save v1.8.8 (nf_tables) on Sun Aug  3 14:25:05 2025
*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:CILIUM_POST_mangle - [0:0]
:CILIUM_PRE_mangle - [0:0]
:KUBE-IPTABLES-HINT - [0:0]
:KUBE-KUBELET-CANARY - [0:0]
:KUBE-PROXY-CANARY - [0:0]
[7478:2706226] -A PREROUTING -m comment --comment "cilium-feeder: CILIUM_PRE_mangle" -j CILIUM_PRE_mangle
[7659:2901859] -A POSTROUTING -m comment --comment "cilium-feeder: CILIUM_POST_mangle" -j CILIUM_POST_mangle
[0:0] -A CILIUM_PRE_mangle ! -o lo -m socket --transparent -m mark ! --mark 0xe00/0xf00 -m mark ! --mark 0x800/0xf00 -m comment --comment "cilium: any->pod redirect proxied traffic to host proxy" -j MARK --set-xmark 0x200/0xffffffff
[0:0] -A CILIUM_PRE_mangle -p tcp -m mark --mark 0xd1b00200 -m comment --comment "cilium: TPROXY to host cilium-dns-egress proxy" -j TPROXY --on-port 45265 --on-ip 127.0.0.1 --tproxy-mark 0x200/0xffffffff
[0:0] -A CILIUM_PRE_mangle -p udp -m mark --mark 0xd1b00200 -m comment --comment "cilium: TPROXY to host cilium-dns-egress proxy" -j TPROXY --on-port 45265 --on-ip 127.0.0.1 --tproxy-mark 0x200/0xffffffff
COMMIT
# Completed on Sun Aug  3 14:25:05 2025
# Generated by iptables-save v1.8.8 (nf_tables) on Sun Aug  3 14:25:05 2025
*raw
:PREROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:CILIUM_OUTPUT_raw - [0:0]
:CILIUM_PRE_raw - [0:0]
[7478:2706226] -A PREROUTING -m comment --comment "cilium-feeder: CILIUM_PRE_raw" -j CILIUM_PRE_raw
[7386:2786229] -A OUTPUT -m comment --comment "cilium-feeder: CILIUM_OUTPUT_raw" -j CILIUM_OUTPUT_raw
[0:0] -A CILIUM_OUTPUT_raw -o lxc+ -m mark --mark 0xa00/0xfffffeff -m comment --comment "cilium: NOTRACK for proxy return traffic" -j CT --notrack
[0:0] -A CILIUM_OUTPUT_raw -o cilium_host -m mark --mark 0xa00/0xfffffeff -m comment --comment "cilium: NOTRACK for proxy return traffic" -j CT --notrack
[0:0] -A CILIUM_OUTPUT_raw -o lxc+ -m mark --mark 0x800/0xe00 -m comment --comment "cilium: NOTRACK for L7 proxy upstream traffic" -j CT --notrack
[0:0] -A CILIUM_OUTPUT_raw -o cilium_host -m mark --mark 0x800/0xe00 -m comment --comment "cilium: NOTRACK for L7 proxy upstream traffic" -j CT --notrack
[0:0] -A CILIUM_PRE_raw -m mark --mark 0x200/0xf00 -m comment --comment "cilium: NOTRACK for proxy traffic" -j CT --notrack
COMMIT
# Completed on Sun Aug  3 14:25:05 2025
# Generated by iptables-save v1.8.8 (nf_tables) on Sun Aug  3 14:25:05 2025
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:CILIUM_FORWARD - [0:0]
:CILIUM_INPUT - [0:0]
:CILIUM_OUTPUT - [0:0]
:KUBE-EXTERNAL-SERVICES - [0:0]
:KUBE-FIREWALL - [0:0]
:KUBE-FORWARD - [0:0]
:KUBE-KUBELET-CANARY - [0:0]
:KUBE-NODEPORTS - [0:0]
:KUBE-PROXY-CANARY - [0:0]
:KUBE-PROXY-FIREWALL - [0:0]
:KUBE-SERVICES - [0:0]
[7204:2590544] -A INPUT -m comment --comment "cilium-feeder: CILIUM_INPUT" -j CILIUM_INPUT
[75809:4920244] -A INPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes load balancer firewall" -j KUBE-PROXY-FIREWALL
[1226020:609184388] -A INPUT -m comment --comment "kubernetes health check service ports" -j KUBE-NODEPORTS
[75809:4920244] -A INPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes externally-visible service portals" -j KUBE-EXTERNAL-SERVICES
[1226403:609687915] -A INPUT -j KUBE-FIREWALL
[273:115630] -A FORWARD -m comment --comment "cilium-feeder: CILIUM_FORWARD" -j CILIUM_FORWARD
[0:0] -A FORWARD -m conntrack --ctstate NEW -m comment --comment "kubernetes load balancer firewall" -j KUBE-PROXY-FIREWALL
[0:0] -A FORWARD -m comment --comment "kubernetes forwarding rules" -j KUBE-FORWARD
[0:0] -A FORWARD -m conntrack --ctstate NEW -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
[0:0] -A FORWARD -m conntrack --ctstate NEW -m comment --comment "kubernetes externally-visible service portals" -j KUBE-EXTERNAL-SERVICES
[7386:2786229] -A OUTPUT -m comment --comment "cilium-feeder: CILIUM_OUTPUT" -j CILIUM_OUTPUT
[120593:8324448] -A OUTPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes load balancer firewall" -j KUBE-PROXY-FIREWALL
[120593:8324448] -A OUTPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
[1168958:130473319] -A OUTPUT -j KUBE-FIREWALL
[169:108416] -A CILIUM_FORWARD -o cilium_host -m comment --comment "cilium: any->cluster on cilium_host forward accept" -j ACCEPT
[0:0] -A CILIUM_FORWARD -i cilium_host -m comment --comment "cilium: cluster->any on cilium_host forward accept (nodeport)" -j ACCEPT
[104:7214] -A CILIUM_FORWARD -i lxc+ -m comment --comment "cilium: cluster->any on lxc+ forward accept" -j ACCEPT
[0:0] -A CILIUM_FORWARD -i cilium_net -m comment --comment "cilium: cluster->any on cilium_net forward accept (nodeport)" -j ACCEPT
[0:0] -A CILIUM_INPUT -m mark --mark 0x200/0xf00 -m comment --comment "cilium: ACCEPT for proxy traffic" -j ACCEPT
[0:0] -A CILIUM_OUTPUT -m mark --mark 0xa00/0xe00 -m comment --comment "cilium: ACCEPT for proxy traffic" -j ACCEPT
[0:0] -A CILIUM_OUTPUT -m mark --mark 0x800/0xe00 -m comment --comment "cilium: ACCEPT for l7 proxy upstream traffic" -j ACCEPT
[7378:2785373] -A CILIUM_OUTPUT -m mark ! --mark 0xe00/0xf00 -m mark ! --mark 0xd00/0xf00 -m mark ! --mark 0x400/0xf00 -m mark ! --mark 0xa00/0xe00 -m mark ! --mark 0x800/0xe00 -m mark ! --mark 0xf00/0xf00 -m comment --comment "cilium: host->any mark as from host" -j MARK --set-xmark 0xc00/0xf00
[0:0] -A KUBE-FIREWALL ! -s 127.0.0.0/8 -d 127.0.0.0/8 -m comment --comment "block incoming localnet connections" -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP
[0:0] -A KUBE-FORWARD -m conntrack --ctstate INVALID -m nfacct --nfacct-name  ct_state_invalid_dropped_pkts -j DROP
[0:0] -A KUBE-FORWARD -m comment --comment "kubernetes forwarding rules" -m mark --mark 0x4000/0x4000 -j ACCEPT
[0:0] -A KUBE-FORWARD -m comment --comment "kubernetes forwarding conntrack rule" -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
COMMIT
# Completed on Sun Aug  3 14:25:05 2025
# Generated by iptables-save v1.8.8 (nf_tables) on Sun Aug  3 14:25:05 2025
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:CILIUM_OUTPUT_nat - [0:0]
:CILIUM_POST_nat - [0:0]
:CILIUM_PRE_nat - [0:0]
:KUBE-KUBELET-CANARY - [0:0]
:KUBE-MARK-MASQ - [0:0]
:KUBE-NODEPORTS - [0:0]
:KUBE-POSTROUTING - [0:0]
:KUBE-PROXY-CANARY - [0:0]
:KUBE-SEP-5VHIAZOUZV3DPFDR - [0:0]
:KUBE-SEP-64AHEXP4T5LYTCIS - [0:0]
:KUBE-SEP-BM3ZWEEADMRKWH33 - [0:0]
:KUBE-SEP-GEIJI4HB2CJ3MWRF - [0:0]
:KUBE-SEP-J7FF4VEFES2CIBI2 - [0:0]
:KUBE-SEP-J7O355AVDO2LIEDL - [0:0]
:KUBE-SEP-POIGFBO5HYYXJ6YG - [0:0]
:KUBE-SEP-SHDGMUJKIHR627UM - [0:0]
:KUBE-SEP-VXTAUZKA3ETFFWWO - [0:0]
:KUBE-SEP-WIKKSB6PRHRLDBSA - [0:0]
:KUBE-SERVICES - [0:0]
:KUBE-SVC-DZSQUIY5BXN7HSA3 - [0:0]
:KUBE-SVC-ERIFXISQEP7F7OF4 - [0:0]
:KUBE-SVC-JD5MR3NA4I4DYORP - [0:0]
:KUBE-SVC-NPX46M4PTMTKRN6Y - [0:0]
:KUBE-SVC-TCOU7JCQXEZGVUNU - [0:0]
:KUBE-SVC-ZGWW2L4XLRSDZ3EF - [0:0]
:KUBE-SVL-NZTS37XDTDNXGCKJ - [0:0]
[55:3008] -A PREROUTING -m comment --comment "cilium-feeder: CILIUM_PRE_nat" -j CILIUM_PRE_nat
[11074:524890] -A PREROUTING -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
[256:15628] -A OUTPUT -m comment --comment "cilium-feeder: CILIUM_OUTPUT_nat" -j CILIUM_OUTPUT_nat
[107641:7418844] -A OUTPUT -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
[256:15628] -A POSTROUTING -m comment --comment "cilium-feeder: CILIUM_POST_nat" -j CILIUM_POST_nat
[107641:7418844] -A POSTROUTING -m comment --comment "kubernetes postrouting rules" -j KUBE-POSTROUTING
[0:0] -A CILIUM_POST_nat -s 10.0.1.0/24 ! -d 10.0.0.0/16 ! -o cilium_+ -m comment --comment "cilium masquerade non-cluster" -j MASQUERADE
[0:0] -A CILIUM_POST_nat -m mark --mark 0xa00/0xe00 -m comment --comment "exclude proxy return traffic from masquerade" -j ACCEPT
[0:0] -A CILIUM_POST_nat ! -s 10.0.1.0/24 ! -d 10.0.1.0/24 -o cilium_host -m comment --comment "cilium host->cluster masquerade" -j SNAT --to-source 10.0.1.138
[0:0] -A CILIUM_POST_nat -s 127.0.0.1/32 -o cilium_host -m comment --comment "cilium host->cluster from 127.0.0.1 masquerade" -j SNAT --to-source 10.0.1.138
[0:0] -A CILIUM_POST_nat -o cilium_host -m mark --mark 0xf00/0xf00 -m conntrack --ctstate DNAT -m comment --comment "hairpin traffic that originated from a local pod" -j SNAT --to-source 10.0.1.138
[0:0] -A KUBE-MARK-MASQ -j MARK --set-xmark 0x4000/0x4000
[17794:1169416] -A KUBE-POSTROUTING -m mark ! --mark 0x4000/0x4000 -j RETURN
[0:0] -A KUBE-POSTROUTING -j MARK --set-xmark 0x4000/0x0
[0:0] -A KUBE-POSTROUTING -m comment --comment "kubernetes service traffic requiring SNAT" -j MASQUERADE --random-fully
[0:0] -A KUBE-SEP-5VHIAZOUZV3DPFDR -s 91.217.196.183/32 -m comment --comment "kube-system/hubble-peer:peer-service" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-5VHIAZOUZV3DPFDR -p tcp -m comment --comment "kube-system/hubble-peer:peer-service" -m tcp -j DNAT --to-destination 91.217.196.183:4244
[0:0] -A KUBE-SEP-64AHEXP4T5LYTCIS -s 10.0.0.34/32 -m comment --comment "kube-system/kube-dns:metrics" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-64AHEXP4T5LYTCIS -p tcp -m comment --comment "kube-system/kube-dns:metrics" -m tcp -j DNAT --to-destination 10.0.0.34:9153
[0:0] -A KUBE-SEP-BM3ZWEEADMRKWH33 -s 10.0.1.41/32 -m comment --comment "kube-system/kube-dns:dns-tcp" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-BM3ZWEEADMRKWH33 -p tcp -m comment --comment "kube-system/kube-dns:dns-tcp" -m tcp -j DNAT --to-destination 10.0.1.41:53
[0:0] -A KUBE-SEP-GEIJI4HB2CJ3MWRF -s 10.0.0.34/32 -m comment --comment "kube-system/kube-dns:dns-tcp" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-GEIJI4HB2CJ3MWRF -p tcp -m comment --comment "kube-system/kube-dns:dns-tcp" -m tcp -j DNAT --to-destination 10.0.0.34:53
[0:0] -A KUBE-SEP-J7FF4VEFES2CIBI2 -s 91.217.196.189/32 -m comment --comment "default/kubernetes:https" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-J7FF4VEFES2CIBI2 -p tcp -m comment --comment "default/kubernetes:https" -m tcp -j DNAT --to-destination 91.217.196.189:6443
[0:0] -A KUBE-SEP-J7O355AVDO2LIEDL -s 10.0.0.216/32 -m comment --comment "kube-system/hubble-relay" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-J7O355AVDO2LIEDL -p tcp -m comment --comment "kube-system/hubble-relay" -m tcp -j DNAT --to-destination 10.0.0.216:4245
[0:0] -A KUBE-SEP-POIGFBO5HYYXJ6YG -s 10.0.1.41/32 -m comment --comment "kube-system/kube-dns:dns" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-POIGFBO5HYYXJ6YG -p udp -m comment --comment "kube-system/kube-dns:dns" -m udp -j DNAT --to-destination 10.0.1.41:53
[0:0] -A KUBE-SEP-SHDGMUJKIHR627UM -s 10.0.1.41/32 -m comment --comment "kube-system/kube-dns:metrics" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-SHDGMUJKIHR627UM -p tcp -m comment --comment "kube-system/kube-dns:metrics" -m tcp -j DNAT --to-destination 10.0.1.41:9153
[0:0] -A KUBE-SEP-VXTAUZKA3ETFFWWO -s 10.0.0.127/32 -m comment --comment "kube-system/hubble-ui:http" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-VXTAUZKA3ETFFWWO -p tcp -m comment --comment "kube-system/hubble-ui:http" -m tcp -j DNAT --to-destination 10.0.0.127:8081
[0:0] -A KUBE-SEP-WIKKSB6PRHRLDBSA -s 10.0.0.34/32 -m comment --comment "kube-system/kube-dns:dns" -j KUBE-MARK-MASQ
[0:0] -A KUBE-SEP-WIKKSB6PRHRLDBSA -p udp -m comment --comment "kube-system/kube-dns:dns" -m udp -j DNAT --to-destination 10.0.0.34:53
[0:0] -A KUBE-SERVICES -d 10.100.5.190/32 -p tcp -m comment --comment "kube-system/hubble-relay cluster IP" -m tcp --dport 80 -j KUBE-SVC-DZSQUIY5BXN7HSA3
[0:0] -A KUBE-SERVICES -d 10.102.253.180/32 -p tcp -m comment --comment "kube-system/hubble-ui:http cluster IP" -m tcp --dport 80 -j KUBE-SVC-ZGWW2L4XLRSDZ3EF
[0:0] -A KUBE-SERVICES -d 10.96.0.10/32 -p udp -m comment --comment "kube-system/kube-dns:dns cluster IP" -m udp --dport 53 -j KUBE-SVC-TCOU7JCQXEZGVUNU
[0:0] -A KUBE-SERVICES -d 10.96.0.10/32 -p tcp -m comment --comment "kube-system/kube-dns:dns-tcp cluster IP" -m tcp --dport 53 -j KUBE-SVC-ERIFXISQEP7F7OF4
[0:0] -A KUBE-SERVICES -d 10.96.0.10/32 -p tcp -m comment --comment "kube-system/kube-dns:metrics cluster IP" -m tcp --dport 9153 -j KUBE-SVC-JD5MR3NA4I4DYORP
[0:0] -A KUBE-SERVICES -d 10.96.0.1/32 -p tcp -m comment --comment "default/kubernetes:https cluster IP" -m tcp --dport 443 -j KUBE-SVC-NPX46M4PTMTKRN6Y
[0:0] -A KUBE-SERVICES -d 10.110.211.28/32 -p tcp -m comment --comment "kube-system/hubble-peer:peer-service cluster IP" -m tcp --dport 443 -j KUBE-SVL-NZTS37XDTDNXGCKJ
[9283:582416] -A KUBE-SERVICES -m comment --comment "kubernetes service nodeports; NOTE: this must be the last rule in this chain" -m addrtype --dst-type LOCAL -j KUBE-NODEPORTS
[0:0] -A KUBE-SVC-DZSQUIY5BXN7HSA3 ! -s 10.0.0.0/16 -d 10.100.5.190/32 -p tcp -m comment --comment "kube-system/hubble-relay cluster IP" -m tcp --dport 80 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVC-DZSQUIY5BXN7HSA3 -m comment --comment "kube-system/hubble-relay -> 10.0.0.216:4245" -j KUBE-SEP-J7O355AVDO2LIEDL
[0:0] -A KUBE-SVC-ERIFXISQEP7F7OF4 ! -s 10.0.0.0/16 -d 10.96.0.10/32 -p tcp -m comment --comment "kube-system/kube-dns:dns-tcp cluster IP" -m tcp --dport 53 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVC-ERIFXISQEP7F7OF4 -m comment --comment "kube-system/kube-dns:dns-tcp -> 10.0.0.34:53" -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-GEIJI4HB2CJ3MWRF
[0:0] -A KUBE-SVC-ERIFXISQEP7F7OF4 -m comment --comment "kube-system/kube-dns:dns-tcp -> 10.0.1.41:53" -j KUBE-SEP-BM3ZWEEADMRKWH33
[0:0] -A KUBE-SVC-JD5MR3NA4I4DYORP ! -s 10.0.0.0/16 -d 10.96.0.10/32 -p tcp -m comment --comment "kube-system/kube-dns:metrics cluster IP" -m tcp --dport 9153 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVC-JD5MR3NA4I4DYORP -m comment --comment "kube-system/kube-dns:metrics -> 10.0.0.34:9153" -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-64AHEXP4T5LYTCIS
[0:0] -A KUBE-SVC-JD5MR3NA4I4DYORP -m comment --comment "kube-system/kube-dns:metrics -> 10.0.1.41:9153" -j KUBE-SEP-SHDGMUJKIHR627UM
[0:0] -A KUBE-SVC-NPX46M4PTMTKRN6Y ! -s 10.0.0.0/16 -d 10.96.0.1/32 -p tcp -m comment --comment "default/kubernetes:https cluster IP" -m tcp --dport 443 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVC-NPX46M4PTMTKRN6Y -m comment --comment "default/kubernetes:https -> 91.217.196.189:6443" -j KUBE-SEP-J7FF4VEFES2CIBI2
[0:0] -A KUBE-SVC-TCOU7JCQXEZGVUNU ! -s 10.0.0.0/16 -d 10.96.0.10/32 -p udp -m comment --comment "kube-system/kube-dns:dns cluster IP" -m udp --dport 53 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVC-TCOU7JCQXEZGVUNU -m comment --comment "kube-system/kube-dns:dns -> 10.0.0.34:53" -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-WIKKSB6PRHRLDBSA
[0:0] -A KUBE-SVC-TCOU7JCQXEZGVUNU -m comment --comment "kube-system/kube-dns:dns -> 10.0.1.41:53" -j KUBE-SEP-POIGFBO5HYYXJ6YG
[0:0] -A KUBE-SVC-ZGWW2L4XLRSDZ3EF ! -s 10.0.0.0/16 -d 10.102.253.180/32 -p tcp -m comment --comment "kube-system/hubble-ui:http cluster IP" -m tcp --dport 80 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVC-ZGWW2L4XLRSDZ3EF -m comment --comment "kube-system/hubble-ui:http -> 10.0.0.127:8081" -j KUBE-SEP-VXTAUZKA3ETFFWWO
[0:0] -A KUBE-SVL-NZTS37XDTDNXGCKJ ! -s 10.0.0.0/16 -d 10.110.211.28/32 -p tcp -m comment --comment "kube-system/hubble-peer:peer-service cluster IP" -m tcp --dport 443 -j KUBE-MARK-MASQ
[0:0] -A KUBE-SVL-NZTS37XDTDNXGCKJ -m comment --comment "kube-system/hubble-peer:peer-service -> 91.217.196.183:4244" -j KUBE-SEP-5VHIAZOUZV3DPFDR
COMMIT
# Completed on Sun Aug  3 14:25:05 2025
