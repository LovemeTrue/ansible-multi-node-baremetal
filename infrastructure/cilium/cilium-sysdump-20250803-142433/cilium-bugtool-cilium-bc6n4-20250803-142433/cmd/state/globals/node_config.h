#include "lib/utils.h"

/*
 cilium.v4.external.str 91.217.196.189
 cilium.v4.internal.str 10.0.0.124
 cilium.v4.nodeport.str [91.217.196.189]

 cilium.v4.internal.raw 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0x0, 0x0, 0x7c
 */

#define CT_MAP_SIZE_TCP 131072
#define CT_MAP_SIZE_ANY 65536
DECLARE_CONFIG(__u32, identity_length, "Identity length in bits");
ASSIGN_CONFIG(__u32, identity_length, 16);
DECLARE_CONFIG(__u32, interface_ifindex, "ifindex of the interface the bpf program is attached to");
#define ALLOW_ICMP_FRAG_NEEDED 1
#define AUTH_MAP_SIZE 524288
#define CIDR_IDENTITY_RANGE_END 33554431
#define CIDR_IDENTITY_RANGE_START 16777217
#define CILIUM_HOST_IFINDEX 4
#define CILIUM_HOST_MAC {.addr={0x8a,0x2a,0xc0,0x92,0x10,0x72}}
#define CILIUM_IPV4_FRAG_MAP_MAX_ENTRIES 8192
#define CILIUM_LB_AFFINITY_MAP_MAX_ENTRIES 65536
#define CILIUM_LB_BACKENDS_MAP_MAX_ENTRIES 65536
#define CILIUM_LB_MAGLEV_MAP_MAX_ENTRIES 65536
#define CILIUM_LB_REV_NAT_MAP_MAX_ENTRIES 65536
#define CILIUM_LB_SERVICE_MAP_MAX_ENTRIES 65536
#define CILIUM_LB_SKIP_MAP_MAX_ENTRIES 100
#define CILIUM_LB_SOURCE_RANGE_MAP_MAX_ENTRIES 65536
#define CILIUM_NET_IFINDEX 3
#define CILIUM_NET_MAC {.addr={0xd2,0x13,0x35,0x37,0x8b,0xfc}}
#define CLUSTER_ID_MAX 255
#define CONFIG_MAP_SIZE 256
#define CT_CLOSE_TIMEOUT 10
#define CT_CONNECTION_LIFETIME_NONTCP 60
#define CT_CONNECTION_LIFETIME_TCP 8000
#define CT_REPORT_FLAGS 0x00ff
#define CT_REPORT_INTERVAL 5
#define CT_SERVICE_CLOSE_REBALANCE 60
#define CT_SERVICE_LIFETIME_NONTCP 60
#define CT_SERVICE_LIFETIME_TCP 8000
#define CT_SYN_TIMEOUT 60
#define DIRECT_ROUTING_DEV_IFINDEX 2
#define DSR_ENCAP_GENEVE 3
#define DSR_ENCAP_IPIP 2
#define DSR_ENCAP_MODE 0
#define DSR_ENCAP_NONE 1
#define EGRESS_POLICY_MAP_SIZE 16384
#define ENABLE_ICMP_RULE 1
#define ENABLE_IDENTITY_MARK 1
#define ENABLE_IPV4 1
#define ENABLE_IPV4_FRAGMENTS 1
#define ENABLE_LOCAL_REDIRECT_POLICY 1
#define ENABLE_NODEPORT 1
#define ENABLE_SERVICE_PROTOCOL_DIFFERENTIATION 1
#define ENABLE_SESSION_AFFINITY 1
#define ENABLE_SOCKET_LB_FULL 1
#define ENABLE_SOCKET_LB_PEER 1
#define ENABLE_SRC_RANGE_CHECK 1
#define ENCAP_IFINDEX 5
#define ENCRYPTED_OVERLAY_ID 11
#define ENDPOINTS_MAP_SIZE 65535
#define EPHEMERAL_MIN 32768
#define EVENTS_MAP_BURST_LIMIT 0
#define EVENTS_MAP_RATE_LIMIT 0
#define HASH_INIT4_SEED 1910299206
#define HASH_INIT6_SEED 2454738568
#define HEALTH_ID 4
#define HOST_ID 1
#define HOST_NETNS_COOKIE 1
#define INIT_ID 5
#define IPCACHE_MAP_SIZE 512000
#define IPV4_DIRECT_ROUTING 3183794523
#define IPV4_GATEWAY 0x7c00000a
#define IPV4_MASK 0xffffff
#define IPV4_RSS_PREFIX IPV4_DIRECT_ROUTING
#define IPV4_RSS_PREFIX_BITS 32
#define IS_L3_DEV(ifindex) false
#define KERNEL_HZ 250
#define KUBE_APISERVER_NODE_ID 7
#define L2_RESPONDER_MAP4_SIZE 4096
#define LB4_REVERSE_NAT_SK_MAP_SIZE 65536
#define LB4_SRC_RANGE_MAP_SIZE 65536
#define LB6_REVERSE_NAT_SK_MAP_SIZE 65536
#define LB_SELECTION 1
#define LB_SELECTION_MAGLEV 2
#define LB_SELECTION_RANDOM 1
#define LOCAL_NODE_ID 6
#define METRICS_MAP_SIZE 1024
#define MTU 1500
#define NATIVE_DEV_MAC_BY_IFINDEX(IFINDEX) ({ \
union macaddr __mac = {.addr = {0x0, 0x0, 0x0, 0x0, 0x0, 0x0}}; \
switch (IFINDEX) { \
 case 2: {union macaddr __tmp = {.addr = {0xbc,0x24,0x11,0x57,0x4e,0xfb}}; __mac=__tmp;} break; \
} \
__mac; })
#define NAT_46X64_PREFIX_0 0
#define NAT_46X64_PREFIX_1 0
#define NAT_46X64_PREFIX_2 0
#define NAT_46X64_PREFIX_3 0
#define NODEPORT_NEIGH4_SIZE 131072
#define NODEPORT_PORT_MAX 32767
#define NODEPORT_PORT_MAX_NAT 65535
#define NODEPORT_PORT_MIN 30000
#define NODEPORT_PORT_MIN_NAT 32768
#define NODE_MAP_SIZE 16384
#define POLICY_MAP_SIZE 16384
#define POLICY_PROG_MAP_SIZE 65535
#define POLICY_STATS_MAP_SIZE 65536
#define REMOTE_NODE_ID 6
#define SERVICE_NO_BACKEND_RESPONSE 1
#define SNAT_COLLISION_RETRIES 32
#define SNAT_MAPPING_IPV4_SIZE 131072
#define THIS_INTERFACE_IFINDEX CONFIG(interface_ifindex)
#define TRACE_SOCK_NOTIFY 1
#define TUNNEL_MODE 1
#define TUNNEL_PORT 8472
#define TUNNEL_PROTOCOL 1
#define TUNNEL_PROTOCOL_GENEVE 2
#define TUNNEL_PROTOCOL_VXLAN 1
#define TUNNEL_SRC_PORT_HIGH 0
#define TUNNEL_SRC_PORT_LOW 0
#define UNKNOWN_ID 0
#define UNMANAGED_ID 3
#define VLAN_FILTER(ifindex, vlan_id) return false
#define WORLD_ID 2
#define WORLD_IPV4_ID 2
#define WORLD_IPV6_ID 2

// JSON_OUTPUT: eyJBTExPV19JQ01QX0ZSQUdfTkVFREVEIjoiMSIsIkFVVEhfTUFQX1NJWkUiOiI1MjQyODgiLCJDSURSX0lERU5USVRZX1JBTkdFX0VORCI6IjMzNTU0NDMxIiwiQ0lEUl9JREVOVElUWV9SQU5HRV9TVEFSVCI6IjE2Nzc3MjE3IiwiQ0lMSVVNX0hPU1RfSUZJTkRFWCI6IjQiLCJDSUxJVU1fSE9TVF9NQUMiOiJ7LmFkZHI9ezB4OGEsMHgyYSwweGMwLDB4OTIsMHgxMCwweDcyfX0iLCJDSUxJVU1fSVBWNF9GUkFHX01BUF9NQVhfRU5UUklFUyI6IjgxOTIiLCJDSUxJVU1fTEJfQUZGSU5JVFlfTUFQX01BWF9FTlRSSUVTIjoiNjU1MzYiLCJDSUxJVU1fTEJfQkFDS0VORFNfTUFQX01BWF9FTlRSSUVTIjoiNjU1MzYiLCJDSUxJVU1fTEJfTUFHTEVWX01BUF9NQVhfRU5UUklFUyI6IjY1NTM2IiwiQ0lMSVVNX0xCX1JFVl9OQVRfTUFQX01BWF9FTlRSSUVTIjoiNjU1MzYiLCJDSUxJVU1fTEJfU0VSVklDRV9NQVBfTUFYX0VOVFJJRVMiOiI2NTUzNiIsIkNJTElVTV9MQl9TS0lQX01BUF9NQVhfRU5UUklFUyI6IjEwMCIsIkNJTElVTV9MQl9TT1VSQ0VfUkFOR0VfTUFQX01BWF9FTlRSSUVTIjoiNjU1MzYiLCJDSUxJVU1fTkVUX0lGSU5ERVgiOiIzIiwiQ0lMSVVNX05FVF9NQUMiOiJ7LmFkZHI9ezB4ZDIsMHgxMywweDM1LDB4MzcsMHg4YiwweGZjfX0iLCJDTFVTVEVSX0lEX01BWCI6IjI1NSIsIkNPTkZJR19NQVBfU0laRSI6IjI1NiIsIkNUX0NMT1NFX1RJTUVPVVQiOiIxMCIsIkNUX0NPTk5FQ1RJT05fTElGRVRJTUVfTk9OVENQIjoiNjAiLCJDVF9DT05ORUNUSU9OX0xJRkVUSU1FX1RDUCI6IjgwMDAiLCJDVF9SRVBPUlRfRkxBR1MiOiIweDAwZmYiLCJDVF9SRVBPUlRfSU5URVJWQUwiOiI1IiwiQ1RfU0VSVklDRV9DTE9TRV9SRUJBTEFOQ0UiOiI2MCIsIkNUX1NFUlZJQ0VfTElGRVRJTUVfTk9OVENQIjoiNjAiLCJDVF9TRVJWSUNFX0xJRkVUSU1FX1RDUCI6IjgwMDAiLCJDVF9TWU5fVElNRU9VVCI6IjYwIiwiRElSRUNUX1JPVVRJTkdfREVWX0lGSU5ERVgiOiIyIiwiRFNSX0VOQ0FQX0dFTkVWRSI6IjMiLCJEU1JfRU5DQVBfSVBJUCI6IjIiLCJEU1JfRU5DQVBfTU9ERSI6IjAiLCJEU1JfRU5DQVBfTk9ORSI6IjEiLCJFR1JFU1NfUE9MSUNZX01BUF9TSVpFIjoiMTYzODQiLCJFTkFCTEVfSUNNUF9SVUxFIjoiMSIsIkVOQUJMRV9JREVOVElUWV9NQVJLIjoiMSIsIkVOQUJMRV9JUFY0IjoiMSIsIkVOQUJMRV9JUFY0X0ZSQUdNRU5UUyI6IjEiLCJFTkFCTEVfTE9DQUxfUkVESVJFQ1RfUE9MSUNZIjoiMSIsIkVOQUJMRV9OT0RFUE9SVCI6IjEiLCJFTkFCTEVfU0VSVklDRV9QUk9UT0NPTF9ESUZGRVJFTlRJQVRJT04iOiIxIiwiRU5BQkxFX1NFU1NJT05fQUZGSU5JVFkiOiIxIiwiRU5BQkxFX1NPQ0tFVF9MQl9GVUxMIjoiMSIsIkVOQUJMRV9TT0NLRVRfTEJfUEVFUiI6IjEiLCJFTkFCTEVfU1JDX1JBTkdFX0NIRUNLIjoiMSIsIkVOQ0FQX0lGSU5ERVgiOiI1IiwiRU5DUllQVEVEX09WRVJMQVlfSUQiOiIxMSIsIkVORFBPSU5UU19NQVBfU0laRSI6IjY1NTM1IiwiRVBIRU1FUkFMX01JTiI6IjMyNzY4IiwiRVZFTlRTX01BUF9CVVJTVF9MSU1JVCI6IjAiLCJFVkVOVFNfTUFQX1JBVEVfTElNSVQiOiIwIiwiSEFTSF9JTklUNF9TRUVEIjoiMTkxMDI5OTIwNiIsIkhBU0hfSU5JVDZfU0VFRCI6IjI0NTQ3Mzg1NjgiLCJIRUFMVEhfSUQiOiI0IiwiSE9TVF9JRCI6IjEiLCJIT1NUX05FVE5TX0NPT0tJRSI6IjEiLCJJTklUX0lEIjoiNSIsIklQQ0FDSEVfTUFQX1NJWkUiOiI1MTIwMDAiLCJJUFY0X0RJUkVDVF9ST1VUSU5HIjoiMzE4Mzc5NDUyMyIsIklQVjRfR0FURVdBWSI6IjB4N2MwMDAwMGEiLCJJUFY0X01BU0siOiIweGZmZmZmZiIsIklQVjRfUlNTX1BSRUZJWCI6IklQVjRfRElSRUNUX1JPVVRJTkciLCJJUFY0X1JTU19QUkVGSVhfQklUUyI6IjMyIiwiSVNfTDNfREVWKGlmaW5kZXgpIjoiZmFsc2UiLCJLRVJORUxfSFoiOiIyNTAiLCJLVUJFX0FQSVNFUlZFUl9OT0RFX0lEIjoiNyIsIkwyX1JFU1BPTkRFUl9NQVA0X1NJWkUiOiI0MDk2IiwiTEI0X1JFVkVSU0VfTkFUX1NLX01BUF9TSVpFIjoiNjU1MzYiLCJMQjRfU1JDX1JBTkdFX01BUF9TSVpFIjoiNjU1MzYiLCJMQjZfUkVWRVJTRV9OQVRfU0tfTUFQX1NJWkUiOiI2NTUzNiIsIkxCX1NFTEVDVElPTiI6IjEiLCJMQl9TRUxFQ1RJT05fTUFHTEVWIjoiMiIsIkxCX1NFTEVDVElPTl9SQU5ET00iOiIxIiwiTE9DQUxfTk9ERV9JRCI6IjYiLCJNRVRSSUNTX01BUF9TSVpFIjoiMTAyNCIsIk1UVSI6IjE1MDAiLCJOQVRJVkVfREVWX01BQ19CWV9JRklOREVYKElGSU5ERVgpIjoiKHsgXFxcbnVuaW9uIG1hY2FkZHIgX19tYWMgPSB7LmFkZHIgPSB7MHgwLCAweDAsIDB4MCwgMHgwLCAweDAsIDB4MH19OyBcXFxuc3dpdGNoIChJRklOREVYKSB7IFxcXG4gY2FzZSAyOiB7dW5pb24gbWFjYWRkciBfX3RtcCA9IHsuYWRkciA9IHsweGJjLDB4MjQsMHgxMSwweDU3LDB4NGUsMHhmYn19OyBfX21hYz1fX3RtcDt9IGJyZWFrOyBcXFxufSBcXFxuX19tYWM7IH0pIiwiTkFUXzQ2WDY0X1BSRUZJWF8wIjoiMCIsIk5BVF80Nlg2NF9QUkVGSVhfMSI6IjAiLCJOQVRfNDZYNjRfUFJFRklYXzIiOiIwIiwiTkFUXzQ2WDY0X1BSRUZJWF8zIjoiMCIsIk5PREVQT1JUX05FSUdINF9TSVpFIjoiMTMxMDcyIiwiTk9ERVBPUlRfUE9SVF9NQVgiOiIzMjc2NyIsIk5PREVQT1JUX1BPUlRfTUFYX05BVCI6IjY1NTM1IiwiTk9ERVBPUlRfUE9SVF9NSU4iOiIzMDAwMCIsIk5PREVQT1JUX1BPUlRfTUlOX05BVCI6IjMyNzY4IiwiTk9ERV9NQVBfU0laRSI6IjE2Mzg0IiwiUE9MSUNZX01BUF9TSVpFIjoiMTYzODQiLCJQT0xJQ1lfUFJPR19NQVBfU0laRSI6IjY1NTM1IiwiUE9MSUNZX1NUQVRTX01BUF9TSVpFIjoiNjU1MzYiLCJSRU1PVEVfTk9ERV9JRCI6IjYiLCJTRVJWSUNFX05PX0JBQ0tFTkRfUkVTUE9OU0UiOiIxIiwiU05BVF9DT0xMSVNJT05fUkVUUklFUyI6IjMyIiwiU05BVF9NQVBQSU5HX0lQVjRfU0laRSI6IjEzMTA3MiIsIlRISVNfSU5URVJGQUNFX0lGSU5ERVgiOiJDT05GSUcoaW50ZXJmYWNlX2lmaW5kZXgpIiwiVFJBQ0VfU09DS19OT1RJRlkiOiIxIiwiVFVOTkVMX01PREUiOiIxIiwiVFVOTkVMX1BPUlQiOiI4NDcyIiwiVFVOTkVMX1BST1RPQ09MIjoiMSIsIlRVTk5FTF9QUk9UT0NPTF9HRU5FVkUiOiIyIiwiVFVOTkVMX1BST1RPQ09MX1ZYTEFOIjoiMSIsIlRVTk5FTF9TUkNfUE9SVF9ISUdIIjoiMCIsIlRVTk5FTF9TUkNfUE9SVF9MT1ciOiIwIiwiVU5LTk9XTl9JRCI6IjAiLCJVTk1BTkFHRURfSUQiOiIzIiwiVkxBTl9GSUxURVIoaWZpbmRleCwgdmxhbl9pZCkiOiJyZXR1cm4gZmFsc2UiLCJXT1JMRF9JRCI6IjIiLCJXT1JMRF9JUFY0X0lEIjoiMiIsIldPUkxEX0lQVjZfSUQiOiIyIn0=
